<h1>Market</h1>

<%= form_with url: search_stock_in_market_path, method: :post, remote: true do | f |%>
    <%# text_field_tag "ticker_input", nil, placeholder: "Enter Ticker Symbol" %>
    <%# submit_tag "Search" %>
    <div class="input-group mb-3">
        <%= f.text_field "ticker_input",
             placeholder: "Enter Ticker Symbol", type: "text",
             class:"form-control"%>
        <%= f.button "Search", class: "btn btn-outline-primary", id: "button-addon2",
            data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Searching..."} %>
    </div>
<% end %>

<br>

<div id ="stock-searched">
    <%# render "market/qoute" %>
</div>

<% if @markets %>
    <% @markets.each do |market| %>
        <% @client = IEX::Api::Client.new() %>
        <%  @quote = @client.quote(market.name) %>
        <div class="card" style="width: 18rem;">
            <div class="card-body">
                <h5 class="card-title"><%= @quote.symbol %></h5>
                <h6 class="card-subtitle mb-2 text-muted"><%= @quote.company_name %></h6>
                <p class="card-text">
                    $<%= @quote.latest_price%><br>
                    <%= @quote.change_percent_s %><br>
                    <%= @quote.change%><br>
                </p>
                <div class="" id="market">
                    <%# <div id="chart-fill"
                        data-dailychart-values="12.94,13.0,12.98,13.02,13.0,13.0,12.95,12.85,13.04,13.13"
                        data-dailychart-close="13.08"
                        data-dailychart-length="78">
                    </div> %>
                    <div class="chart-fill" id="chart-fill-positive"
                        data-dailychart-close="1289.0" data-dailychart-length="93"
                        data-dailychart-values="1292.2,1292.0,1292.1,1291.8,1291.8,1292.1,1291.9,1291.6,1291.7,1291.7,1291.6,1291.8,1291.6,1291.7,1292.0,1291.6,1291.4,1291.2,1290.5,1290.5,1290.6,1290.5,1290.4,1289.8,1289.5,1290.0,1289.6,1289.7,1289.1,1288.8,1289,1289.2,1289.4,1289.7,1289.7,1289.6,1289.2,1290.1,1290.3,1290.5,1290.7,1292.3,1292.5,1291.7,1292.1,1292.1,1292.6,1292.7,1292.8,1292.7,1292.2,1291.7,1292.1,1292.1,1291.7,1291.2,1291.7,1291.9,1291.6,1292.1,1292.5,1293.6,1293.3,1293.8,1293.9,1293.5,1293.7,1293.6,1294.1,1295.0,1296.9,1297.0,1296.3,1296.5,1296.6,1296.6,1296.1,1296.4,1296.1,1296.5,1296.7,1296.0,1296.1,1296.7,1296.1,1296.1,1296.2,1296.0,1296.1,1295.9,1295.7,1296.0,1296.4">
                </div>
            </div>
        </div>
    <% end %>
<% end %>