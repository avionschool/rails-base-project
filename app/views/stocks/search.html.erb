<div class="dashboard_index">
  <%=render 'shared/nav_dashboard'%>
  <div class="dashboard_body">
    <div class="markets_body">
      <div class="markets_grid">
          <%=render 'shared/bid_orders', :buy_orders => @buy_orders %>
        <div class="main_charts_grid">
          <div class="main_charts card">
              <%= form_tag search_stock_path, method: :get do %>
              <div class="form-group">
                <div class="col-sm-9 main_charts_search">
                  <%= text_field_tag :stock, params[:stock], placeholder: "Stock ticker symbol", autofocus: true, class: "form-control form-control-sm" %>
                  <%= button_tag type: :submit, class: "btn btn-warning main_charts_search_button" do %>
                  <%= "Search" %>
                <% end %>
              </div>
              <div class="col-sm-12 no-left-padding">
                <div id="results">  
                  <% if @stock %>
                    <span class="result_symbol"><%= @stock.ticker %></span> 
                    <span class="result_company"><%= @stock.name %></span> 
                    <span class="result_price"><%= @stock.last_price %></span> 
                  <% end %>
                </div>
                <div class="main_charts_graph">
                  <canvas id="myChart" width="400" height="200"></canvas>
                </div>
                <div class="main_charts_forms">
                  <div class="main_charts_forms_buy">
                    <div class="main_charts_forms_buy_labels main_charts_forms_item">
                      <span>Limit</span>
                      <span>Market</span>
                      <span>Stop Limit</span>
                    </div>
                    <div class="form-group" id="buy_orders_form">
                      <%= form_with model: @buy_order, url: stock_buy_path, method: :post, local: true do |f| %>
                        <%= f.number_field :quantity, autofocus: true, class: "form-control main_charts_forms_item", placeholder: "Quantity"%>
                        <%= f.number_field :price, autofocus: true, class: "form-control main_charts_forms_item", placeholder: "Price"%>
                        <input type="number" readonly class="form-control main_charts_forms_item" id="form_buy_amount" placeholder="Total">
                        <%if @stock%>
                            <%= f.submit "BUY #{@stock.ticker}", class: 'btn btn-success main_charts_forms_button main_charts_forms_item' %>
                        <%end%>
                      <%end%>
                    </div>
                  </div>
                  <div class="main_charts_forms_sell">
                    <div class="main_charts_forms_sell_labels main_charts_forms_item">
                      <span>$10,000</span>
                      <span>Available balance</span>
                    </div>
                    <div class="form-group" id="sell_orders_form">
                        <%= form_with model: @sell_order, url: stock_sell_path, method: :post, local: true do |f| %>
                          <%# <%= render "shared/errors", obj: @sell_order %>
                          <%= f.hidden_field :stock, value: @stock.id.to_i %>
                          <%= f.number_field :quantity, autofocus: true, class: "form-control main_charts_forms_item", placeholder: "Quantity"%>
                          <%= f.number_field :price, autofocus: true, class: "form-control main_charts_forms_item", placeholder: "Price"%>
                          <input type="number" readonly class="form-control main_charts_forms_item" id="form_buy_amount" placeholder="Total">
                          <%if @stock%>
                              <%= f.submit "SELL #{@stock.ticker}", class: 'btn btn-danger main_charts_forms_button main_charts_forms_item' %>
                          <%end%>
                      <%end%>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <% end %>
          </div>
          <div class="main_buy_sell_form">
          </div>
        </div>
        <%=render 'shared/sell_orders', :sell_orders => @sell_orders %>
      </div>
    </div>
  </div>
  <%=@errors%>
</div>

